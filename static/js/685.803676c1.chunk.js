"use strict";(self.webpackChunkvara_arena=self.webpackChunkvara_arena||[]).push([[685],{2174:(e,t,n)=>{n.d(t,{L:()=>s,S9:()=>d,_H:()=>o,kw:()=>h});n(9664);var r=n(7613),a=n(6070);const l=(0,a.B)("\n  query BattleLogs {\n    battleLogs {\n      id\n      battleIndex\n      character1 {\n        winner\n        attributes\n        character\n        experience\n        rating\n        level\n      }\n      character2 {\n        winner\n        attributes\n        experience\n        character\n        level\n        rating\n      }\n      lobby {\n        id\n        tier\n        capacity\n        reservationsCount\n        characters {\n          id\n          character {\n            owner\n            name\n            level\n            experience\n            attributes\n            id\n          }\n        }\n      }\n      turns {\n        character1 {\n          energy\n          hp\n          position\n        }\n        logs {\n          action\n          character\n        }\n        character2 {\n          energy\n          position\n          hp\n        }\n      }\n    }\n  }\n"),o=()=>(0,r.a)(l,void 0,{select:e=>e.battleLogs}),i=(0,a.B)("\n  query BattleLogById($battleId: String!) {\n    battleLogById(id: $battleId) {\n      id\n      battleIndex\n      character1 {\n        winner\n        attributes\n        character\n        experience\n        rating\n        level\n      }\n      character2 {\n        winner\n        attributes\n        experience\n        character\n        level\n        rating\n      }\n      lobby {\n        id\n        tier\n        reservationsCount\n        capacity\n        characters {\n          id\n          character {\n            owner\n            name\n            level\n            experience\n            attributes\n            id\n          }\n        }\n      }\n      turns {\n        character1 {\n          energy\n          hp\n          position\n\n          chillingTouch\n          earthSkin\n          earthSmites\n          fireHaste\n          fireWall\n          waterBurst\n        }\n        logs {\n          action\n          character\n        }\n        character2 {\n          energy\n          position\n          hp\n\n          chillingTouch\n          earthSkin\n          earthSmites\n          fireHaste\n          fireWall\n          waterBurst\n        }\n      }\n    }\n  }\n"),s=e=>{let{battleId:t}=e;return(0,r.a)(i,{battleId:`${t}`},{enabled:null!=t,select:e=>e.battleLogById,placeholderData:e=>e})},c=(0,a.B)("\n  query BattleLogsByLobbyId($lobbyId: String!) {\n    battleLogs(where: { lobby: { id_eq: $lobbyId } }) {\n      id\n    }\n  }\n"),d=e=>{let{lobbyId:t}=e;return(0,r.a)(c,{lobbyId:`${t}`},{enabled:null!=t,select:e=>e.battleLogs})},h=(e,t)=>{var n;return null===(n=e.lobby.characters.find((e=>{let{character:{id:n}}=e;return n===t})))||void 0===n?void 0:n.character}},2685:(e,t,n)=>{n.r(t),n.d(t,{History:()=>w});var r=n(763),a=n(2174),l=n(7065),o=n(5413),i=n(2020),s=n(8769),c=n(2765),d=(0,n(7469).Z)("search","IconSearch",[["path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M21 21l-6 -6",key:"svg-1"}]]),h=n(9032),b=n(7689),u=n(1087),m=n(2791),p=n(8311),v=n(1313),y=n(5619),g=n(184);const w=()=>{const e=(0,b.s0)(),t=(0,v.i)(),[n,w]=m.useState(""),{data:C}=(0,p.AX)({owner_eq:null!==t&&void 0!==t?t:""}),{data:k}=(0,a._H)(),[I,B]=(0,u.lr)(),N="true"===I.get("filtered");(0,m.useEffect)((()=>{I.get("filtered")||B("filtered=true")}),[]);const T=m.useMemo((()=>null===k||void 0===k?void 0:k.sort(((e,t)=>parseInt(e.id)-parseInt(t.id)))),[k]),H=m.useMemo((()=>{var e;if(!N)return T;const t=null!==(e=null===C||void 0===C?void 0:C.characters.map((e=>e.id)))&&void 0!==e?e:[];return null===T||void 0===T?void 0:T.filter((e=>t.includes(e.character1.character)||t.includes(e.character2.character)))}),[T,N,null===C||void 0===C?void 0:C.characters]),j=m.useMemo((()=>n?null===H||void 0===H?void 0:H.filter((e=>{if(e.lobby.id.toLowerCase().includes(n.toLowerCase()))return!0;if(e.id.toLowerCase().includes(n.toLowerCase()))return!0;return S(e).some((e=>null===e||void 0===e?void 0:e.name.toLowerCase().includes(n.toLowerCase())))})):H),[H,n]),L=m.useMemo((()=>{var e;return null!==(e=null===j||void 0===j?void 0:j.toReversed().map((e=>{const{id:n}=e,r=S(e),a=r.map((e=>{var t;return null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"Player not found"})),l=r.map((e=>{var t;return null!==(t=null===e||void 0===e?void 0:e.owner)&&void 0!==t?t:"Player not found"})),o=e.character1.winner?r[0]:e.character2.winner?r[1]:{name:"No winner",owner:""},i=null===o||void 0===o?void 0:o.name,s=null===o||void 0===o?void 0:o.owner,c=l.includes(null!==t&&void 0!==t?t:"")||s&&s===t;return{playersNames:a,battleId:n,lobbyId:e.lobby.id,tier:e.lobby.tier,winner:i,includesMyCharacter:c}})))&&void 0!==e?e:[]}),[j,t]),E="200px";return(0,g.jsx)("div",{className:"logs",children:(0,g.jsxs)("div",{className:"modal_leaderboard",children:[(0,g.jsxs)(l.k,{style:{alignSelf:"stretch"},mb:"xs",justify:"space-between",w:"100%",children:[(0,g.jsx)(y.k,{w:E,size:"sm",bg:"black",onClick:()=>B((e=>{const t=new URLSearchParams(e);return t.set("filtered",N?"false":"true"),t})),children:N?"Show all logs":"Show my logs only"}),(0,g.jsx)(o.o,{w:E,size:"sm",placeholder:"Search by ID or name",rightSectionWidth:42,styles:{input:{backgroundColor:"rgba(0, 0, 0, 0.8)",border:"2px solid white",color:"white"}},c:"white",leftSection:(0,g.jsx)(d,{style:{width:(0,i.h)(18),height:(0,i.h)(18)},color:"white",stroke:2.5}),onChange:e=>{(0,r.debounce)((()=>{w(e.target.value)}),300,{maxWait:1e3})()}})]}),(0,g.jsx)("div",{className:"header",children:"History"}),(0,g.jsx)("div",{className:"modal_table",children:(0,g.jsxs)(s.i,{horizontalSpacing:"md",verticalSpacing:"md",children:[(0,g.jsx)(s.i.Thead,{children:(0,g.jsx)(s.i.Tr,{children:["Lobby ID","Battle ID","Tier","Players","Winner"].map(((e,t)=>(0,g.jsx)(s.i.Th,{w:f[t],ta:x[t],children:e},e)))})}),(0,g.jsx)(s.i.Tbody,{children:L.map((t=>(0,g.jsx)(s.i.Tr,{onClick:()=>{const[n,r]=t.battleId.split("-");e(h._.tournamentResult({lobbyId:n,battleId:r}))},className:["table_row",t.includesMyCharacter&&!N?"table_row_highlighted":""].join(" "),children:[(0,g.jsxs)("div",{className:"badge",children:[" ",t.lobbyId]}),(0,g.jsx)("div",{className:"badge",children:t.battleId}),(0,g.jsx)(c.x,{ta:"center",size:"sm",fw:"500",children:t.tier}),t.playersNames.map((e=>(0,g.jsx)("div",{children:e},e))),t.winner].map(((e,t)=>(0,g.jsx)(s.i.Td,{w:f[t],ta:x[t],children:e},t)))},`${t.battleId}-${t.lobbyId}`)))})]})})]})})},f={0:"100px",1:"100px",2:"40px"},x={0:"center",1:"center",2:"center"};function S(e){return[e.character1.character,e.character2.character].map((t=>(0,a.kw)(e,t)))}},8769:(e,t,n)=>{n.d(t,{i:()=>E});var r=n(2791),a=n(2020),l=n(5146),o=n(5838),i=n(3768),s=n(6519),c=n(204),d=n(245),h=n(8592),b=n(4799);const[u,m]=(0,b.R)("Table component was not found in the tree");var p={table:"m-b23fa0ef",th:"m-4e7aa4f3",tr:"m-4e7aa4fd",td:"m-4e7aa4ef",tbody:"m-b2404537",thead:"m-b242d975",caption:"m-9e5a3ac7",scrollContainer:"m-a100c15",scrollContainerInner:"m-62259741"};function v(e,t){if(!t)return;const n={};return t.columnBorder&&e.withColumnBorders&&(n["data-with-column-border"]=!0),t.rowBorder&&e.withRowBorders&&(n["data-with-row-border"]=!0),t.striped&&e.striped&&(n["data-striped"]=e.striped),t.highlightOnHover&&e.highlightOnHover&&(n["data-hover"]=!0),t.captionSide&&e.captionSide&&(n["data-side"]=e.captionSide),t.stickyHeader&&e.stickyHeader&&(n["data-sticky"]=!0),n}function y(e,t){const n=`Table${e.charAt(0).toUpperCase()}${e.slice(1)}`,a=(0,h.d)(((a,l)=>{const o=(0,s.w)(n,{},a),{classNames:i,className:c,style:h,styles:b,...u}=o,p=m();return r.createElement(d.x,{component:e,ref:l,...v(p,t),...p.getStyles(e,{className:c,classNames:i,style:h,styles:b,props:o}),...u})}));return a.displayName=`@mantine/core/${n}`,a.classes=p,a}const g=y("th",{columnBorder:!0}),w=y("td",{columnBorder:!0}),f=y("tr",{rowBorder:!0,striped:!0,highlightOnHover:!0}),x=y("thead",{stickyHeader:!0}),S=y("tbody"),C=y("tfoot"),k=y("caption",{captionSide:!0});function I(e){let{data:t}=e;return r.createElement(r.Fragment,null,t.caption&&r.createElement(k,null,t.caption),t.head&&r.createElement(x,null,r.createElement(f,null,t.head.map(((e,t)=>r.createElement(g,{key:t},e))))),t.body&&r.createElement(S,null,t.body.map(((e,t)=>r.createElement(f,{key:t},e.map(((e,t)=>r.createElement(w,{key:t},e))))))),t.foot&&r.createElement(C,null,r.createElement(f,null,t.foot.map(((e,t)=>r.createElement(g,{key:t},e))))))}I.displayName="@mantine/core/TableDataRenderer";var B=n(1619);const N={type:"scrollarea"},T=(0,o.Z)(((e,t)=>{let{minWidth:n,type:r}=t;return{scrollContainer:{"--table-min-width":(0,a.h)(n),"--table-overflow":"native"===r?"auto":void 0}}})),H=(0,h.d)(((e,t)=>{const n=(0,s.w)("TableScrollContainer",N,e),{classNames:a,className:l,style:o,styles:i,unstyled:h,vars:b,children:u,minWidth:m,type:v,...y}=n,g=(0,c.y)({name:"TableScrollContainer",classes:p,props:n,className:l,style:o,classNames:a,styles:i,unstyled:h,vars:b,varsResolver:T,rootSelector:"scrollContainer"});return r.createElement(d.x,{component:"scrollarea"===v?B.x:"div",..."scrollarea"===v?{offsetScrollbars:"x"}:{},ref:t,...g("scrollContainer"),...y},r.createElement("div",{...g("scrollContainerInner")},u))}));H.classes=p,H.displayName="@mantine/core/TableScrollContainer";const j={withRowBorders:!0,verticalSpacing:7},L=(0,o.Z)(((e,t)=>{let{layout:n,captionSide:r,horizontalSpacing:o,verticalSpacing:s,borderColor:c,stripedColor:d,highlightOnHoverColor:h,striped:b,highlightOnHover:u,stickyHeaderOffset:m,stickyHeader:p}=t;return{table:{"--table-layout":n,"--table-caption-side":r,"--table-horizontal-spacing":(0,l.bG)(o),"--table-vertical-spacing":(0,l.bG)(s),"--table-border-color":c?(0,i.p)(c,e):void 0,"--table-striped-color":b&&d?(0,i.p)(d,e):void 0,"--table-highlight-on-hover-color":u&&h?(0,i.p)(h,e):void 0,"--table-sticky-header-offset":p?(0,a.h)(m):void 0}}})),E=(0,h.d)(((e,t)=>{const n=(0,s.w)("Table",j,e),{classNames:a,className:l,style:o,styles:i,unstyled:h,vars:b,horizontalSpacing:m,verticalSpacing:v,captionSide:y,stripedColor:g,highlightOnHoverColor:w,striped:f,highlightOnHover:x,withColumnBorders:S,withRowBorders:C,withTableBorder:k,borderColor:B,layout:N,variant:T,data:H,children:E,stickyHeader:R,stickyHeaderOffset:_,...$}=n,O=(0,c.y)({name:"Table",props:n,className:l,style:o,classes:p,classNames:a,styles:i,unstyled:h,rootSelector:"table",vars:b,varsResolver:L});return r.createElement(u,{value:{getStyles:O,stickyHeader:R,striped:!0===f?"odd":f||void 0,highlightOnHover:x,withColumnBorders:S,withRowBorders:C,captionSide:y||"bottom"}},r.createElement(d.x,{component:"table",variant:T,ref:t,mod:{"data-with-table-border":k},...O("table"),...$},E||!!H&&r.createElement(I,{data:H})))}));E.classes=p,E.displayName="@mantine/core/Table",E.Td=w,E.Th=g,E.Tr=f,E.Thead=x,E.Tbody=S,E.Tfoot=C,E.Caption=k,E.ScrollContainer=H,E.DataRenderer=I}}]);
//# sourceMappingURL=685.803676c1.chunk.js.map